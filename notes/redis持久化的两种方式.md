# redis提供了2中不同形式的持久化方式：

## 1、RDB(Redis DataBase):

​    在指定的时间间隔内将内存中的数据集快照写入磁盘，也就是行话讲的Snapshot快照，它恢复时是将快照文件直接读到内存里
1、备份是如何执行的:
​        Redis会单独创建（fork）一个子进程来进行持久化，会先将数据写入到一个临时文件中，待持久化过程都结束了，再用这个临时文件替换上次持久化好的文件。整个过程中，主进程是不进行任何IO操作的，这就确保了极高的性能，如果需要进行大规模的数据的恢复，且对于数据恢复的完整性不是非常敏感，那RDB方式要比AOF方式更加高效。RDB的缺点是最后一次持久化的数据可能丢失。
2、RDB的保存的文件
​        在redis.conf中配置文件名称，默认为dump.rdb

```properties
# The filename where to dump the DB
dbfilename dump.rdb
```

​        RDB文件的保存路径，也可以修改，默认为Redis启动时命令行所在的目录下
3、RDB的备份
​        先通过config get dir 查询rdb文件的目录
​        将*.rdb的文件拷贝到别的地方
4、RDB的恢复
​        关闭redis
​        先把备份的文件拷贝到工作目录下
​        启动redis，备份文件会直接加载
5、RDB的优点
​        节省磁盘空间
​        恢复速度快
6、RDB的缺点
​        虽然Redis在fork时使用写写时拷贝技术，但是如果数据庞大时还是比较消耗性能
​        在备份周期在一定时间做一次备份，所以如果redis意外down掉的话，就会丢失最后一次快照的所有修改

## 2、AOF(Append Of File):

​	以日志的形式来记录每个写操作，将redis执行过的所有写指令记录下来（读操作不记录），只许追加文件但不可以修改文件，redis启动之初会读取该文件重新构建数据，换言之，redis重启的话就根据日志文件的内容将写指令从前到后执行一次以完成数据的恢复工作
1、AOF的优点
​        备份机制更稳健，丢失数据概率更低
​        可读的日志文本，通过操作AOF文件，可以处理误操作
2、AOF的缺点
​        比起RDB占用更多的磁盘空间
​        恢复备份速度要慢
​        每次读写都同步的话，有一定的性能压力
​        存在个别bug，造成恢复不能